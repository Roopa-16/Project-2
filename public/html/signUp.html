<!DOCTYPE html>
<header>
    <title>SLR Sign-Up</title>
    <!-- <link rel='stylesheet' href='reset.css'> -->
    <!-- BootStrap -->
    <link rel='stylesheet' href='https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css'
        integrity='sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T' crossorigin='anonymous'>
    <!-- BootStrap jQuery -->
    <script src='https://code.jquery.com/jquery-3.3.1.slim.min.js'
        integrity='sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo'
        crossorigin='anonymous'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js'
        integrity='sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1'
        crossorigin='anonymous'></script>
    <script src='https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js'
        integrity='sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM'
        crossorigin='anonymous'></script>
    <!-- Ajax -->
    <script src='https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.0.min.js'></script>
    <!-- Firebase -->
    <script src='https://www.gstatic.com/firebasejs/4.12.0/firebase.js'></script>
    <link rel='stylesheet' href='../styles/signUp.css'>
</header>

<body background = >
        <form action="/action_page.php" style="border:1px solid #ccc">
            <div class="container">
              <h1>Sign Up</h1>
              <p>Please fill in this form to create an account.</p>
              <hr> 

              <label for="name"><b>Name</b></label>
              <input type="text" placeholder="Enter First and Last name" name="name" required>
          
              <label for="email"><b>Email</b></label>
              <input type="text" placeholder="Enter Email" name="email" required>
          
              <label for="psw"><b>Password</b></label>
              <input type="password" placeholder="Enter Password" name="password" required>
          
              <label for="psw-repeat"><b>Confirm Password</b></label>
              <input type="password" placeholder="Confirm Password" name="confirm" required>
              
              <!-- <label>
                <input type="checkbox" checked="checked" name="remember" style="margin-bottom:15px"> Remember me
              </label> -->
              
              <!-- <p>By creating an account you agree to our <a href="#" style="color:dodgerblue">Terms & Privacy</a>.</p>
           -->
              <div class="clearfix">
                <button type="button" class="cancelbtn">Cancel</button>
                <button type="submit" class="signupbtn">Sign Up</button>
              </div>
            </div>
          </form>
    <!-- <div class="jumbotron">
        <h1>Submission Form</h1>
        <br>
        <div class="input-group">
            <div class="input-group-prepend">
                <span class="input-group-text">First and last name</span>
            </div>
            <input type="text" aria-label="name" class="form-control" id="name" required>
        </div>
        <br>
        <h4 id="displayError"></h4>
        <br>
        <div class="input-group">
            <div class="input-group-prepend">
                <span class="input-group-text">Email Address</span>
            </div>
            <input type="text" aria-label="email" class="form-control" id="email" required>
        </div>
        <br>
        <div class="input-group">
            <div class="input-group-prepend">
                <span class="input-group-text">Password</span>
            </div>
            <input type="text" aria-label="password" class="form-control" id="password" required>
            <input type="text" aria-label="confirm" class="form-control" id="confirm"  placeholder="Confirm your Password" required>
        </div>
        <button id="submit" type="submit" class="btn btn-success btn-lg">Submit</button>
    </div> -->
</body>
<script type='text/javascript'>

    const config = {
        apiKey: "AIzaSyB_m_T5HTRv8nJag2AiCxVKk-9ft_k0BzY",
        authDomain: "project-2-a5345.firebaseapp.com",
        databaseURL: "https://project-2-a5345.firebaseio.com",
        projectId: "project-2-a5345",
        storageBucket: "project-2-a5345.appspot.com",
        messagingSenderId: "649772621947",
        appId: "1:649772621947:web:36fce6153aa474885ec2de"
    };

    firebase.initializeApp(config);

    var database = firebase.database();
    var user;

    $("#submit").on("click", function (event) {
        event.preventDefault();
        var isValid = true;
        $(".form-control").each(function () {
            if ($(this).val() === "") {
                isValid = false;
                alert("Please fill out all fields before submitting!");
                return isValid;
            }
        });
        const email = $("#email")
            .val()
            .trim();
        const password = $("#password")
            .val()
            .trim();
        const auth = firebase.auth();

        const promise = auth.createUserWithEmailAndPassword(email, password);
        $("#displayError").text("");
        promise.catch(e => {
            console.log(e.message);
            $("#displayError").text(e.message);
        });
        var newUser = {
            email: $("#email").val().trim(),
            name: $("#name").val().trim()
        }
        $.ajax({
            headers: {
                "Content-Type": "application/json"
            },
            type: "POST",
            url: "/signUp/new",
            data: JSON.stringify(newUser)
        });
    });

    firebase.auth().onAuthStateChanged(firebaseUser => {
        if (firebaseUser) {
            $.ajax({
                url: "/redirect/home",
                method: 'GET'
            }).then(function (res) { });
            console.log(firebaseUser);
            user = firebaseUser;

            console.log(firebaseUser.email);
        } else {

        }
    });

</script>

</html>